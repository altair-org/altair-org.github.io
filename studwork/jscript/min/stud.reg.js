jQuery(document).ready(function(e){function t(t){var n=!1,a=g(t,"Введите логин");return a?e.ajax({url:"https://ajax.studwork.org/testingLoginEmail.php",type:"GET",data:"login="+a,cache:!1,async:!1,success:function(e){e=e.trim(),"no"==e?(set_input_flag(t,!1),c(t,!1,"Логин занят"),n=!1):(set_input_flag(t,!0),c(t,!0,"Логин свободен"),n=!0)}}):n=!1,a.length<4&&(set_input_flag(t,!1),c(t,!1,"Логин должен содержать не менее 4 символов"),n=!1),a.length>15&&(set_input_flag(t,!1),c(t,!1,"Логин должен содержать не более 15 символов"),n=!1),app.form.loginRegExp.test(a)||(set_input_flag(t,!1),c(t,!1,"Только латинские и русские буквы, цифры, пробел и ( _ )"),n=!1),n}function n(e){var t=g(e,"Введите имя");return t.length<2?(set_input_flag(e,!1),c(e,!1,"Имя должно содержать не менее 2 символов"),field_flag=!1):t&&(c(e,!0,"Спасибо :) Теперь мы знаем, как к вам обращаться"),field_flag=!0),field_flag}function a(e){var t=g(e,"Введите пароль");return t.length<5&&(set_input_flag(e,!1),c(e,!1,"Пароль должен содержать не менее 5 символов"),field_flag=!1),field_flag}function i(t){var n=!1,a=g(t,"Введите почту");return u.test(a)?e.ajax({url:"https://ajax.studwork.org/testingLoginEmail.php",type:"GET",data:"email="+a,cache:!1,async:!1,success:function(e){e=e.trim(),"no"==e?(set_input_flag(t,!1),c(t,!1,"Email занят"),n=!1):(set_input_flag(t,!0),c(t,!0,"Email свободен"),n=!0)}}):(set_input_flag(t,!1),c(t,!1,"Введите корректный email"),n=!1),n}function r(t){var n=!1,a=g(t,"Введите номер телефона");return a.length<11?(set_input_flag(t,!1),c(t,!1,"Введите номер в международном формате (не менее 11 цифр)"),n=!1):a?e.ajax({url:"https://ajax.studwork.org/testingLoginEmail.php",type:"GET",data:"phone="+a,cache:!1,async:!1,success:function(e){e=e.trim(),"no"==e?(set_input_flag(t,!1),c(t,!1,"Номер телефона занят"),n=!1):(set_input_flag(t,!0),c(t,!0,"Номер телефона свободен"),n=!0)}}):n=!1,n}function s(t){return t.attr("checked")?(e("#reg-check-err").slideUp(300),!0):(e("#reg-check-err").slideDown(300),!1)}function g(e,t){return""!=e.val()?(set_input_flag(e,!0),e.val()):""==e.val()?(set_input_flag(e,!1),c(e,!1,t),!1):void 0}function c(e,t,n){t||e.parent().next().css({color:"#e84c3d"}).text(n),t&&e.parent().next().css({color:"#1bbc9d"}).text(n)}var l=0,u=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;e("#reg-phone").bind("change keyup input click",function(){this.value.match(/[^0-9\+]/g)&&(this.value=this.value.replace(/[^0-9\+]/g,""))}),e("#reg-pass").bind("change keyup input click",function(){if(e(this).val().length>0){var t=zxcvbn(e("#reg-pass").val()),n=t.entropy;30>=n&&e(this).parent().next().text("Слабый пароль").css("color","#e84c3d"),n>30&&70>=n&&e(this).parent().next().text("Средний пароль").css("color","#ffd133"),n>70&&e(this).parent().next().text("Сильный пароль").css("color","#1bbc9d")}}),e("#reg-login").change(function(){t(e(this))}),e("#reg-name").change(function(){n(e(this))}),e("#reg-pass").change(function(){a(e(this))}),e("#reg-mail").change(function(){i(e(this))}),e("#reg-phone").change(function(){r(e(this))}),e("#stud-reg-form").submit(function(){var g=t(e("#reg-login")),c=n(e("#reg-name")),u=a(e("#reg-pass")),o=i(e("#reg-mail")),f=r(e("#reg-phone")),p=s(e("#reg-check"));if(!g)return e("#reg-login").focus(),!1;if(!c)return e("#reg-name").focus(),!1;if(!u)return e("#reg-pass").focus(),!1;if(!o)return e("#reg-mail").focus(),!1;if(!f)return e("#reg-phone").focus(),!1;if(0==l&&g&&c&&u&&o&&f&&p){l=1;var h={login:e("#reg-login").val(),name:e("#reg-name").val(),password:e("#reg-pass").val(),email:e("#reg-mail").val(),phone:e("#reg-phone").val()};AjaxRequest("Registration",JSON.stringify(h),secret_hash_reg)}return!1})});